<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="en"
      th:replace="~{layout/layout :: layout(~{::title}, ~{::main}, ~{::scripts}, 'cars')}">
<head>
    <title>Fleet Management - DriveSmart</title>
</head>
<body>
    <main th:fragment="main-content">
        <!-- Header -->
        <div class="container mb-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 style="font-size: 1.75rem; font-weight: bold; color: #5D707F; margin-bottom: 0.5rem;">Fleet Management</h1>
                    <p style="color: #6C757D;">Manage your vehicle inventory</p>
                </div>
                <a th:href="@{/cars/add}" class="btn btn-primary">Add New Vehicle</a>
            </div>
        </div>

        <!-- Stats -->
        <div class="container mb-4">
            <div class="grid-4">
                <div class="card text-center">
                    <div style="margin-bottom: 0.5rem;"><img src="/images/logov1-removebg-preview.png" alt="DriveSmart" style="height:32px"></div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #5D707F; margin-bottom: 0.25rem;" th:text="${totalCars ?: '42'}">42</div>
                    <div style="color: #6C757D; font-size: 0.875rem;">Total Vehicles</div>
                </div>
                <div class="card text-center">
                    <div style="font-size: 2rem; color: #66CED6; margin-bottom: 0.5rem;">âœ…</div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #5D707F; margin-bottom: 0.25rem;" th:text="${availableCars ?: '28'}">28</div>
                    <div style="color: #6C757D; font-size: 0.875rem;">Available Now</div>
                </div>
                <div class="card text-center">
                    <div style="font-size: 2rem; color: #66CED6; margin-bottom: 0.5rem;">ðŸ”§</div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #5D707F; margin-bottom: 0.25rem;" th:text="${maintenanceCars ?: '3'}">3</div>
                    <div style="color: #6C757D; font-size: 0.875rem;">In Maintenance</div>
                </div>
                <div class="card text-center">
                    <div style="font-size: 2rem; color: #66CED6; margin-bottom: 0.5rem;">ðŸ“…</div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #5D707F; margin-bottom: 0.25rem;" th:text="${bookedCars ?: '11'}">11</div>
                    <div style="color: #6C757D; font-size: 0.875rem;">Booked Today</div>
                </div>
            </div>
        </div>

        <!-- Filters -->
        <div class="container mb-4">
            <div class="card">
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 200px;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #5D707F;">Search</label>
                        <input type="text" placeholder="Search vehicles..." style="width: 100%; padding: 0.75rem; border: 1px solid #E9ECEF; border-radius: 0.5rem;">
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #5D707F;">Status</label>
                        <select style="width: 100%; padding: 0.75rem; border: 1px solid #E9ECEF; border-radius: 0.5rem;">
                            <option>All Vehicles</option>
                            <option>Available</option>
                            <option>Booked</option>
                            <option>Maintenance</option>
                        </select>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #5D707F;">Type</label>
                        <select style="width: 100%; padding: 0.75rem; border: 1px solid #E9ECEF; border-radius: 0.5rem;">
                            <option>All Types</option>
                            <option>Sedan</option>
                            <option>SUV</option>
                            <option>Truck</option>
                            <option>Luxury</option>
                        </select>
                    </div>
                    <div style="align-self: flex-end;">
                        <button class="btn btn-secondary" style="width: 100%;">Apply Filters</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vehicles Grid -->
        <div class="container">
            <div class="grid-4">
                <div class="card" th:each="c : ${cars}">
                    <div style="background: #F8F9FA; height: 160px; border-radius: 0.5rem; margin-bottom: 1rem;">
                        <img th:if="${c.hasImage()}" th:src="@{${c.imageUrl}}" alt="Car" style="width:100%; height:160px; object-fit: cover; border-radius: 0.5rem;" />
                    </div>
                    <h3 style="font-size: 1.25rem; font-weight: 600; color: #5D707F; margin-bottom: 0.5rem;" th:text="${c.brand} + ' ' + ${c.model} + ' ' + ${c.year}">Car Name</h3>
                    <div style="color: #6C757D; font-size: 0.875rem; margin-bottom: 1rem;">
                        <div th:text="'License: ' + ${c.licensePlate}">License: ABC-123</div>
                        <div>
                            Status: 
                            <span th:if="${c.inMaintenance}" style="color:#FF9500;font-weight:700">Maintenance</span>
                            <span th:if="${!c.inMaintenance}" th:text="${c.isAvailable} ? 'Available' : 'Unavailable'" th:style="${c.isAvailable} ? 'color:#66CED6;font-weight:500' : 'color:#6C757D;font-weight:500'">Available</span>
                        </div>
                        <div th:text="'Daily Rate: $' + ${c.pricePerDay} + '/day'">$0/day</div>
                        <div th:if="${bookedTodayCarIds != null} and ${bookedTodayCarIds.contains(c.id)}" style="margin-top:0.25rem; color:#1E40AF; font-weight:600;">Booked Today</div>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <a th:href="@{'/cars/details?id=' + ${c.id}}" class="btn btn-outline" style="flex: 1;">View Details</a>
                        <a th:if="${c.isAvailable} and ${!c.inMaintenance}" th:href="@{'/bookings/new?carId=' + ${c.id}}" class="btn btn-primary" style="flex: 1;">Book Now</a>
                        <button th:if="${!c.isAvailable} or ${c.inMaintenance}" class="btn" style="flex: 1; background: #F8F9FA; color: #6C757D; cursor: not-allowed;" disabled>Unavailable</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <th:block th:fragment="scripts">
        <script>
            // Simple filter functionality
            document.addEventListener('DOMContentLoaded', function() {
                console.log('Fleet page loaded');
            });
        </script>
    </th:block>
</body>
</html>
